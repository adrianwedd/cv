const CONFIG={DATA_ENDPOINTS:{BASE_CV:'data/base-cv.json',ACTIVITY_SUMMARY:'data/activity-summary.json',AI_ENHANCEMENTS:'data/ai-enhancements.json',GITHUB_API:'https://api.github.com/users/adrianwedd'},CACHE_DURATION:3e5,ANIMATION_DURATION:300,THEME_KEY:'cv-theme',USERNAME:'adrianwedd',PERFORMANCE_BUDGET:{MAX_LOAD_TIME:2e3,CRITICAL_RENDER_TIME:1e3,IMAGE_LAZY_THRESHOLD:50}};class CVApplication{constructor(){this.currentSection='about';this.cache=new Map;this.themePreference=localStorage.getItem(CONFIG.THEME_KEY)||'light';this.isLoading=!0;this.loadingStartTime=Date.now();this.init()}async init(){try{this.applyTheme(this.themePreference);this.setupEventListeners();this.setupNavigationSystem();this.setupThemeToggle();await this.loadApplicationData();this.initializeLiveStats();this.initializeContentSections();this.handleInitialRoute();this.completeLoadingSequence()}catch(e){console.error('❌ Application initialization failed:',e);this.handleInitializationError(e)}}setupEventListeners(){document.addEventListener('click',e=>{const navItem=e.target.closest('.nav-item');if(navItem){e.preventDefault();const section=navItem.dataset.section;section&&this.navigateToSection(section)}});document.addEventListener('keydown',e=>{'Tab'===e.key&&document.body.classList.add('keyboard-navigation')});window.addEventListener('hashchange',()=>{this.handleHashChange()});let resizeTimeout;window.addEventListener('resize',()=>{clearTimeout(resizeTimeout);resizeTimeout=setTimeout(()=>{this.handleWindowResize()},150)});document.addEventListener('visibilitychange',()=>{document.hidden||this.refreshLiveData()})}setupNavigationSystem(){document.querySelectorAll('.nav-item').forEach(item=>{item.addEventListener('click',e=>{e.preventDefault();const section=item.dataset.section;this.navigateToSection(section)})})}setupThemeToggle(){const themeToggle=document.getElementById('theme-toggle'),themeIcon=themeToggle?.querySelector('.theme-icon');themeToggle&&(themeToggle.addEventListener('click',()=>{this.toggleTheme()}),themeIcon&&(themeIcon.textContent='dark'===this.themePreference?'☀️':'🌙'))}async loadApplicationData(){const dataPromises=[this.loadCVData(),this.loadActivityData(),this.loadAIEnhancements(),this.loadGitHubStats()];try{const[cvData,activityData,aiData,githubStats]=await Promise.allSettled(dataPromises);this.cvData='fulfilled'===cvData.status?cvData.value:{};this.activityData='fulfilled'===activityData.status?activityData.value:{};this.aiEnhancements='fulfilled'===aiData.status?aiData.value:{};this.githubStats='fulfilled'===githubStats.status?githubStats.value:{}}catch(e){console.warn('⚠️ Some data failed to load:',e)}}async loadCVData(){try{const response=await fetch(CONFIG.DATA_ENDPOINTS.BASE_CV);if(!response.ok)throw new Error(`HTTP ${response.status}`);return await response.json()}catch(e){console.warn('⚠️ CV data not available, using defaults');return this.getDefaultCVData()}}async loadActivityData(){try{const summaryResponse=await fetch(CONFIG.DATA_ENDPOINTS.ACTIVITY_SUMMARY);if(!summaryResponse.ok)throw new Error(`HTTP ${summaryResponse.status}`);const activitySummary=await summaryResponse.json(),latestActivityFile=activitySummary?.data_files?.latest_activity;if(latestActivityFile){const detailedActivityResponse=await fetch(`data/activity/${latestActivityFile}`);if(detailedActivityResponse.ok){const detailedActivityData=await detailedActivityResponse.json();activitySummary.skill_analysis=detailedActivityData.skill_analysis}}return activitySummary}catch(e){return console.warn('⚠️ Activity data not available',e),{}}}async loadAIEnhancements(){try{const response=await fetch(CONFIG.DATA_ENDPOINTS.AI_ENHANCEMENTS);if(!response.ok)throw new Error(`HTTP ${response.status}`);return await response.json()}catch(e){return console.warn('⚠️ AI enhancements not available',e),{}}}async loadGitHubStats(){try{const response=await fetch(CONFIG.DATA_ENDPOINTS.GITHUB_API);if(!response.ok)throw new Error(`HTTP ${response.status}`);return await response.json()}catch(e){return console.warn('⚠️ GitHub stats not available',e),{}}}toggleTheme(){this.themePreference='light'===this.themePreference?'dark':'light';this.applyTheme(this.themePreference);localStorage.setItem(CONFIG.THEME_KEY,this.themePreference);const themeIcon=document.querySelector('.theme-icon');themeIcon&&(themeIcon.textContent='dark'===this.themePreference?'☀️':'🌙')}applyTheme(theme){document.documentElement.setAttribute('data-theme',theme)}navigateToSection(section){this.currentSection=section;window.history.pushState({section},``,`#${section}`);this.updateActiveNavigation(section);this.showSection(section)}updateActiveNavigation(activeSection){document.querySelectorAll('.nav-item').forEach(item=>{item.classList.toggle('active',item.dataset.section===activeSection)})}showSection(section){document.querySelectorAll('.section').forEach(sec=>{sec.style.display=sec.id===section||sec.dataset.section===section?'block':'none'})}handleInitialRoute(){const hash=window.location.hash.slice(1);hash?this.navigateToSection(hash):this.navigateToSection('about')}handleHashChange(){const hash=window.location.hash.slice(1);hash&&this.navigateToSection(hash)}initializeLiveStats(){this.updateLiveStats()}async updateLiveStats(){try{const stats=await this.calculateLiveStats();this.displayLiveStats(stats)}catch(e){console.warn('⚠️ Failed to update live stats:',e)}}async calculateLiveStats(){const stats={repositories:this.githubStats.public_repos||0,commits:this.activityData?.github?.total_commits||0,languages:7,experience:'5+ years',location:'Tasmania, Australia'};return stats}displayLiveStats(stats){const elements={repositories:document.getElementById('live-repositories'),commits:document.getElementById('live-commits'),languages:document.getElementById('live-languages'),experience:document.getElementById('live-experience'),location:document.getElementById('live-location')};Object.entries(stats).forEach(([key,value])=>{const element=elements[key];element&&(element.textContent=value)})}initializeContentSections(){document.querySelectorAll('.section').forEach(section=>{this.animateSection(section)})}animateSection(section){const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{entry.isIntersecting&&entry.target.classList.add('visible')})},{threshold:.1});observer.observe(section)}refreshLiveData(){this.updateLiveStats()}completeLoadingSequence(){setTimeout(()=>{const loadingScreen=document.querySelector('.loading-screen');loadingScreen&&loadingScreen.classList.add('hidden');this.isLoading=!1},1e3)}handleInitializationError(error){const loadingScreen=document.querySelector('.loading-screen');loadingScreen&&(loadingScreen.innerHTML='<div class="loading-content"><h2>Loading Error</h2><p>Please refresh the page</p></div>')}getDefaultCVData(){return{personal_info:{name:'Adrian Wedd',title:'Systems Analyst & Full-Stack Developer',location:'Tasmania, Australia'},professional_summary:'Experienced systems analyst and full-stack developer with expertise in web technologies and data analysis.',experience:[],projects:[],skills:[],achievements:[],education:[]}}handleWindowResize(){}}document.addEventListener('DOMContentLoaded',()=>{window.cvApp=new CVApplication;if('serviceWorker'in navigator){navigator.serviceWorker.register('/sw.js').catch(e=>console.log('SW registration failed'))}});document.addEventListener('click',e=>{const mobileToggle=e.target.closest('.mobile-menu-toggle');if(mobileToggle){e.preventDefault();const navMenu=document.querySelector('.nav-menu');navMenu&&navMenu.classList.toggle('active')}});window.addEventListener('resize',()=>{window.innerWidth>768&&document.querySelector('.nav-menu')?.classList.remove('active')});