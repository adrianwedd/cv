<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: .github/scripts/cv-generator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">

  <!-- Preload critical assets -->
  <link rel="preload" href="/assets/versioned/styles-consolidated.min.css" as="style">
  <link rel="preload" href="/assets/versioned/script-consolidated.min.js" as="script">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: .github/scripts/cv-generator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/usr/bin/env node

/**
 * CV Website Generator
 * 
 * Generates the complete CV website by combining base CV data, GitHub activity
 * metrics, and AI enhancements into a production-ready static site.
 * 
 * Features:
 * - Dynamic content compilation from multiple data sources
 * - Responsive HTML generation with optimized assets
 * - GitHub Pages deployment preparation
 * - SEO optimization and meta tag generation
 * - Performance optimization and asset bundling
 * 
 * Usage: node cv-generator.js
 * Output: ./dist/ directory with complete website
 */

const fs = require('fs').promises;
const puppeteer = require('puppeteer');
const path = require('path');

// Configuration
const CONFIG = {
    INPUT_DIR: '.',
    OUTPUT_DIR: 'dist',
    DATA_DIR: 'data',
    ASSETS_DIR: 'assets',
    TEMPLATE_FILE: 'index.html',
    SITE_URL: 'https://adrianwedd.github.io/cv',
    GITHUB_USERNAME: 'adrianwedd'
};

/**
 * CV Website Generator
 * 
 * Compiles all CV data sources into a production-ready website
 */
class CVGenerator {
    constructor() {
        this.generationStartTime = Date.now();
        this.cvData = {};
        this.activityData = {};
        this.aiEnhancements = {};
    }

    /**
     * Generate complete CV website
     */
    async generate() {
        
        
        

        try {
            // Prepare output directory
            await this.prepareOutputDirectory();

            // Load all data sources
            await this.loadDataSources();

            // Generate website components
            await this.generateHTML();
            await this.copyAssets();
            await this.generatePDF(); // New call
            await this.generateSitemap();
            await this.generateRobotsTxt();
            await this.generateManifest();

            // Generate additional files for GitHub Pages
            await this.generateGitHubPagesFiles();

            const generationTime = ((Date.now() - this.generationStartTime) / 1000).toFixed(2);
            
            
            

        } catch (error) {
            console.error('❌ Website generation failed:', error.message);
            throw error;
        }
    }

    /**
     * Prepare output directory
     */
    async prepareOutputDirectory() {
        
        
        try {
            // Remove existing directory
            await fs.rm(CONFIG.OUTPUT_DIR, { recursive: true, force: true });
            
            // Create fresh directory
            await fs.mkdir(CONFIG.OUTPUT_DIR, { recursive: true });
            
            
        } catch (error) {
            console.error('❌ Failed to prepare output directory:', error.message);
            throw error;
        }
    }

    /**
     * Load all data sources
     */
    async loadDataSources() {
        

        try {
            // Load base CV data
            try {
                const cvDataPath = path.join(CONFIG.DATA_DIR, 'base-cv.json');
                const cvDataContent = await fs.readFile(cvDataPath, 'utf8');
                this.cvData = JSON.parse(cvDataContent);
                
            } catch (error) {
                console.warn('⚠️ Base CV data not found, using defaults');
                this.cvData = this.getDefaultCVData();
            }

            // Load activity data
            try {
                const activityPath = path.join(CONFIG.DATA_DIR, 'activity-summary.json');
                const activityContent = await fs.readFile(activityPath, 'utf8');
                this.activityData = JSON.parse(activityContent);
                
            } catch (error) {
                console.warn('⚠️ Activity data not found');
                this.activityData = {};
            }

            // Load AI enhancements
            try {
                const aiPath = path.join(CONFIG.DATA_DIR, 'ai-enhancements.json');
                const aiContent = await fs.readFile(aiPath, 'utf8');
                this.aiEnhancements = JSON.parse(aiContent);
                
            } catch (error) {
                console.warn('⚠️ AI enhancements not found');
                this.aiEnhancements = {};
            }

        } catch (error) {
            console.error('❌ Failed to load data sources:', error.message);
            throw error;
        }
    }

    /**
     * Generate HTML file with dynamic content
     */
    async generateHTML() {
        

        try {
            // Read template HTML
            const templatePath = path.join(CONFIG.INPUT_DIR, CONFIG.TEMPLATE_FILE);
            let htmlContent = await fs.readFile(templatePath, 'utf8');

            // Process template with data
            htmlContent = await this.processHTMLTemplate(htmlContent);

            // Write processed HTML
            const outputPath = path.join(CONFIG.OUTPUT_DIR, 'index.html');
            await fs.writeFile(outputPath, htmlContent, 'utf8');

            

        } catch (error) {
            console.error('❌ HTML generation failed:', error.message);
            throw error;
        }
    }

    /**
     * Process HTML template with dynamic data
     */
    async processHTMLTemplate(htmlContent) {
        // Update meta tags
        htmlContent = this.updateMetaTags(htmlContent);
        
        // Update structured data
        htmlContent = this.updateStructuredData(htmlContent);
        
        // Update dynamic content placeholders
        htmlContent = this.updateDynamicContent(htmlContent);

        return htmlContent;
    }

    /**
     * Update meta tags with dynamic content
     */
    updateMetaTags(htmlContent) {
        const personalInfo = this.cvData.personal_info || {};
        const name = personalInfo.name || 'Adrian Wedd';
        const title = personalInfo.title || 'AI Engineer &amp; Software Architect';
        const description = this.aiEnhancements?.professional_summary?.enhanced || 
                           this.cvData.professional_summary || 
                           'AI Engineer &amp; Software Architect specializing in autonomous systems, machine learning, and innovative technology solutions';

        // Update title
        htmlContent = htmlContent.replace(
            /&lt;title>.*?&lt;\/title>/,
            `&lt;title>${name} - ${title}&lt;/title>`
        );

        // Update meta description
        htmlContent = htmlContent.replace(
            /&lt;meta name="description" content=".*?">/,
            `&lt;meta name="description" content="${description.substring(0, 160)}...">`
        );

        // Update Open Graph tags
        htmlContent = htmlContent.replace(
            /&lt;meta property="og:title" content=".*?">/,
            `&lt;meta property="og:title" content="${name} - ${title}">`
        );

        htmlContent = htmlContent.replace(
            /&lt;meta property="og:description" content=".*?">/,
            `&lt;meta property="og:description" content="${description.substring(0, 160)}...">`
        );

        return htmlContent;
    }

    /**
     * Update structured data
     */
    updateStructuredData(htmlContent) {
        const personalInfo = this.cvData.personal_info || {};
        const skills = this.cvData.skills || [];
        
        const structuredData = {
            "@context": "https://schema.org",
            "@type": "Person",
            "name": personalInfo.name || "Adrian Wedd",
            "jobTitle": personalInfo.title || "AI Engineer &amp; Software Architect",
            "description": this.aiEnhancements?.professional_summary?.enhanced || this.cvData.professional_summary,
            "url": CONFIG.SITE_URL,
            "sameAs": [
                personalInfo.github || "https://github.com/adrianwedd",
                personalInfo.linkedin || "https://linkedin.com/in/adrianwedd"
            ],
            "knowsAbout": skills.slice(0, 10).map(skill => skill.name),
            "address": {
                "@type": "PostalAddress",
                "addressRegion": "Tasmania",
                "addressCountry": "Australia"
            }
        };

        const structuredDataJson = JSON.stringify(structuredData, null, 2);
        
        htmlContent = htmlContent.replace(
            /&lt;script type="application\/ld\+json">[\s\S]*?&lt;\/script>/,
            `&lt;script type="application/ld+json">\n${structuredDataJson}\n&lt;/script>`
        );

        return htmlContent;
    }

    /**
     * Update dynamic content placeholders
     */
    updateDynamicContent(htmlContent) {
        // Update professional summary if enhanced version available
        if (this.aiEnhancements?.professional_summary?.enhanced) {
            const enhancedSummary = this.aiEnhancements.professional_summary.enhanced;
            htmlContent = htmlContent.replace(
                /(&lt;p class="summary-text" id="professional-summary">)[\s\S]*?(&lt;\/p>)/,
                `$1${enhancedSummary}$2`
            );
        }

        // Add generation timestamp
        const now = new Date();
        htmlContent = htmlContent.replace(
            /(&lt;span id="footer-last-updated">).*?(&lt;\/span>)/,
            `$1${now.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })}$2`
        );

        return htmlContent;
    }

    /**
     * Copy assets to output directory
     */
    async copyAssets() {
        

        try {
            const assetsOutputDir = path.join(CONFIG.OUTPUT_DIR, 'assets');
            await fs.mkdir(assetsOutputDir, { recursive: true });

            // Copy CSS
            const cssSource = path.join(CONFIG.ASSETS_DIR, 'styles.css');
            const cssTarget = path.join(assetsOutputDir, 'styles.css');
            await fs.copyFile(cssSource, cssTarget);

            // Copy JavaScript
            const jsSource = path.join(CONFIG.ASSETS_DIR, 'script.js');
            const jsTarget = path.join(assetsOutputDir, 'script.js');
            await fs.copyFile(jsSource, jsTarget);

            // Copy data directory
            const dataOutputDir = path.join(CONFIG.OUTPUT_DIR, 'data');
            await fs.mkdir(dataOutputDir, { recursive: true });

            // Copy JSON data files
            const dataFiles = ['base-cv.json', 'activity-summary.json', 'ai-enhancements.json'];
            
            for (const file of dataFiles) {
                try {
                    const sourcePath = path.join(CONFIG.DATA_DIR, file);
                    const targetPath = path.join(dataOutputDir, file);
                    await fs.copyFile(sourcePath, targetPath);
                } catch (error) {
                    console.warn(`⚠️ Could not copy ${file}:`, error.message);
                }
            }

            

        } catch (error) {
            console.error('❌ Asset copying failed:', error.message);
            throw error;
        }
    }

    /**
     * Generate sitemap.xml
     */
    async generateSitemap() {
        

        const sitemap = `&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>weekly&lt;/changefreq>
        &lt;priority>1.0&lt;/priority>
    &lt;/url>
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}#about&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>weekly&lt;/changefreq>
        &lt;priority>0.8&lt;/priority>
    &lt;/url>
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}#experience&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>monthly&lt;/changefreq>
        &lt;priority>0.8&lt;/priority>
    &lt;/url>
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}#projects&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>weekly&lt;/changefreq>
        &lt;priority>0.8&lt;/priority>
    &lt;/url>
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}#skills&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>weekly&lt;/changefreq>
        &lt;priority>0.7&lt;/priority>
    &lt;/url>
    &lt;url>
        &lt;loc>${CONFIG.SITE_URL}#achievements&lt;/loc>
        &lt;lastmod>${new Date().toISOString()}&lt;/lastmod>
        &lt;changefreq>monthly&lt;/changefreq>
        &lt;priority>0.7&lt;/priority>
    &lt;/url>
&lt;/urlset>`;

        const sitemapPath = path.join(CONFIG.OUTPUT_DIR, 'sitemap.xml');
        await fs.writeFile(sitemapPath, sitemap, 'utf8');

        
    }

    /**
     * Generate robots.txt
     */
    async generateRobotsTxt() {
        

        const robots = `User-agent: *
Allow: /

Sitemap: ${CONFIG.SITE_URL}/sitemap.xml

# Disallow crawler access to data files for privacy
Disallow: /data/
`;

        const robotsPath = path.join(CONFIG.OUTPUT_DIR, 'robots.txt');
        await fs.writeFile(robotsPath, robots, 'utf8');

        
    }

    /**
     * Generate web manifest
     */
    async generateManifest() {
        

        const personalInfo = this.cvData.personal_info || {};
        
        const manifest = {
            name: `${personalInfo.name || 'Adrian Wedd'} - Professional CV`,
            short_name: personalInfo.name || 'Adrian Wedd',
            description: this.cvData.professional_summary || 'AI Engineer &amp; Software Architect',
            start_url: '/',
            display: 'standalone',
            background_color: '#ffffff',
            theme_color: '#2563eb',
            orientation: 'portrait-primary',
            icons: [
                {
                    src: 'data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">&lt;text y=".9em" font-size="90">🤖&lt;/text>&lt;/svg>',
                    sizes: '192x192',
                    type: 'image/svg+xml'
                }
            ]
        };

        const manifestPath = path.join(CONFIG.OUTPUT_DIR, 'manifest.json');
        await fs.writeFile(manifestPath, JSON.stringify(manifest, null, 2), 'utf8');

        
    }

    /**
     * Generate GitHub Pages specific files
     */
    async generateGitHubPagesFiles() {
        

        // Generate CNAME file if custom domain is specified
        if (process.env.CUSTOM_DOMAIN) {
            const cnamePath = path.join(CONFIG.OUTPUT_DIR, 'CNAME');
            await fs.writeFile(cnamePath, process.env.CUSTOM_DOMAIN, 'utf8');
            
        }

        // Generate .nojekyll to bypass Jekyll processing
        const nojekyllPath = path.join(CONFIG.OUTPUT_DIR, '.nojekyll');
        await fs.writeFile(nojekyllPath, '', 'utf8');
        

        // Generate 404.html
        const notFoundHtml = `&lt;!DOCTYPE html>
&lt;html lang="en">
&lt;head>
    &lt;meta charset="UTF-8">
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0">
    &lt;title>Page Not Found - ${this.cvData.personal_info?.name || 'Adrian Wedd'}&lt;/title>
    &lt;style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #2563eb 0%, #10b981 100%);
            color: white;
            text-align: center;
        }
        .container {
            max-width: 600px;
            padding: 2rem;
        }
        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }
        .btn {
            display: inline-block;
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: background 0.3s ease;
        }
        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    &lt;/style>
&lt;/head>
&lt;body>
    &lt;div class="container">
        &lt;h1>🤖 404&lt;/h1>
        &lt;p>The page you're looking for doesn't exist, but my CV does!&lt;/p>
        &lt;a href="/" class="btn">← Back to CV&lt;/a>
    &lt;/div>
&lt;/body>
&lt;/html>`;

        const notFoundPath = path.join(CONFIG.OUTPUT_DIR, '404.html');
        await fs.writeFile(notFoundPath, notFoundHtml, 'utf8');
        
    }

    /**
     * Generates a high-quality PDF from the generated HTML.
     */
    async generatePDF() {
        
        const browser = await puppeteer.launch({ args: ['--no-sandbox'] }); // --no-sandbox is crucial for running in GitHub Actions
        const page = await browser.newPage();
        
        const htmlPath = path.resolve(path.join(CONFIG.OUTPUT_DIR, 'index.html'));
        await page.goto(`file://${htmlPath}`, { waitUntil: 'networkidle0' });

        // Ensure dark/light theme is set for consistency (e.g., light theme for print)
        await page.evaluate(() => {
            document.documentElement.setAttribute('data-theme', 'light');
        });

        const pdfPath = path.join(CONFIG.OUTPUT_DIR, 'assets', 'adrian-wedd-cv.pdf');
        await page.pdf({
            path: pdfPath,
            format: 'A4',
            printBackground: true,
            margin: {
                top: '20mm',
                right: '20mm',
                bottom: '20mm',
                left: '20mm'
            }
        });

        await browser.close();
        
    }

    /**
     * Get default CV data if no data files are available
     */
    getDefaultCVData() {
        return {
            personal_info: {
                name: "Adrian Wedd",
                title: "AI Engineer &amp; Software Architect",
                location: "Tasmania, Australia",
                github: "https://github.com/adrianwedd",
                linkedin: "https://linkedin.com/in/adrianwedd"
            },
            professional_summary: "AI Engineer and Software Architect specializing in autonomous systems, machine learning, and innovative technology solutions.",
            experience: [],
            projects: [],
            skills: [],
            achievements: []
        };
    }
}

/**
 * Main execution function
 */
async function main() {
    try {
        const generator = new CVGenerator();
        await generator.generate();
        
        
        
        
        
    } catch (error) {
        console.error('❌ Generation failed:', error.message);
        process.exit(1);
    }
}

// Execute if called directly
if (require.main === module) {
    main().catch(console.error);
}

module.exports = { CVGenerator, CONFIG };</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ActivityAnalyzer.html">ActivityAnalyzer</a></li><li><a href="CVApplication.html">CVApplication</a></li><li><a href="CVContentEnhancer.html">CVContentEnhancer</a></li><li><a href="CVGenerator.html">CVGenerator</a></li><li><a href="ClaudeApiClient.html">ClaudeApiClient</a></li><li><a href="GitHubApiClient.html">GitHubApiClient</a></li></ul><h3>Global</h3><ul><li><a href="global.html#fs">fs</a></li><li><a href="global.html#https">https</a></li><li><a href="global.html#main">main</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Wed Jul 30 2025 04:45:15 GMT+1000 (Australian Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
