<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Export Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { border: 1px solid #ccc; margin: 10px 0; padding: 15px; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>üîß CV Export System Debug</h1>
    
    <div class="debug-section">
        <h2>1. CSS Loading Test</h2>
        <div id="css-test">Testing...</div>
    </div>
    
    <div class="debug-section">
        <h2>2. JavaScript Loading Test</h2>
        <div id="js-test">Testing...</div>
    </div>
    
    <div class="debug-section">
        <h2>3. CV Data Loading Test</h2>
        <div id="data-test">Testing...</div>
    </div>
    
    <div class="debug-section">
        <h2>4. Export Button Creation Test</h2>
        <div id="button-test">Testing...</div>
    </div>
    
    <div class="debug-section">
        <h2>5. Console Logs</h2>
        <div id="console-logs"></div>
    </div>

    <!-- Load CV Export System -->
    <link rel="stylesheet" href="assets/cv-export-styles.css">
    <script src="assets/cv-export-system.js"></script>
    
    <script>
        // Debug logging
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn
        };
        
        const logs = [];
        ['log', 'error', 'warn'].forEach(method => {
            console[method] = function(...args) {
                logs.push(`[${method.toUpperCase()}] ${args.join(' ')}`);
                document.getElementById('console-logs').innerHTML = logs.slice(-10).map(log => `<div>${log}</div>`).join('');
                originalConsole[method].apply(console, args);
            };
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Test 1: CSS Loading
            const computedStyle = getComputedStyle(document.documentElement);
            const hasCSSVars = computedStyle.getPropertyValue('--color-primary') || 'NOT FOUND';
            document.getElementById('css-test').innerHTML = `<span class="info">CSS Variables: ${hasCSSVars}</span>`;
            
            // Test 2: JavaScript Classes
            const hasExportClass = typeof CVExportSystem !== 'undefined';
            document.getElementById('js-test').innerHTML = hasExportClass ? 
                '<span class="success">‚úÖ CVExportSystem class loaded</span>' :
                '<span class="error">‚ùå CVExportSystem class not found</span>';
            
            // Test 3: Data Loading
            fetch('data/base-cv.json')
                .then(response => {
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return response.json();
                })
                .then(data => {
                    document.getElementById('data-test').innerHTML = 
                        `<span class="success">‚úÖ CV data loaded (${Object.keys(data).length} sections)</span>`;
                })
                .catch(error => {
                    document.getElementById('data-test').innerHTML = 
                        `<span class="error">‚ùå Data loading failed: ${error.message}</span>`;
                });
            
            // Test 4: Export Button
            setTimeout(() => {
                const exportButton = document.getElementById('cv-export-toggle');
                document.getElementById('button-test').innerHTML = exportButton ? 
                    '<span class="success">‚úÖ Export button created</span>' :
                    '<span class="error">‚ùå Export button not found</span>';
            }, 2000);
        });
    </script>
</body>
</html>